{{- $letters := split "ABCDEFGHIJKLMNOPQRSTUVWXYZ" "" -}}
{{- $pages := .Pages.ByTitle -}}
{{- $pages_by_letters := dict -}}
{{ range $pages }}
{{- $page := . -}}
{{- $first_letter := upper ( substr $page.Name 0 1 ) -}}
{{- if not (in $letters $first_letter) }}
{{ $first_letter = "#" }}
{{ end }}
{{- $new_list := slice -}}
{{ with index $pages_by_letters $first_letter }}
{{- $new_list = . | append $page -}}
{{ else }}
{{- $new_list = slice $page -}}
{{ end }}
{{- $pages_by_letters = merge $pages_by_letters (dict $first_letter $new_list) -}}
{{ end }}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    {{ partial "bootstrap.html" . }}
</head>
<body>
    {{ partial "navbar.html" . }}
    {{ partial "breadcrumb.html" . }}
    <div class="container-fluid">
        <h1>{{ .Title }}</h1>
    </div>
    <div class="container-fluid">
        <div class="row">
            {{ range $key, $items := $pages_by_letters }}
            <div class="col-xs-12 col-md-4 col-lg-3">
                <div class="card mb-3">
                    <div class="card-header">{{ $key }}<sup>{{ len $items }}</sup></div>
                    <ul class="list-group list-group-flush">
                        {{- range $items -}}
                        <li class="list-group-item">
                            <a href="{{ .RelPermalink }}">{{ .Name }}</a>
                        </li>
                        {{- end -}}
                    </ul>
                </div>
            </div>
            {{ end }}
        </div>
    </div>
</body>
</html>